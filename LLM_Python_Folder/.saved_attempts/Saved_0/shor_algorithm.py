from __future__ import print_function; import random; import math; import operator; from functools import reduce; # Step 0: Ensure N is positive and non-trivial and if it is not return 1; # Step 1: Ensure N is not an even number and if it is return 2; # Step 2: Ensure that there is no 'a' such that a**b==N and if there is return it; # Step 3: Choose a random positive non-trivial integer 'x' that is less than N and check once without looping that it does not share a common factor with N and if it does return it; # Step 4: Find r such that x**r % N == 1; # Step 5: If r is even we've found a number with a common factor to N defined as x**r / 2 + 1 xor x**r / 2 - 1, try both and return a non-trivial gcd; # Step 6: If none of the above worked we may have failed or found a prime number, we don't know for certain, return N